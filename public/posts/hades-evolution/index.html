<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="Evolving HADES"><meta property="og:description" content="This post describes how HADES evolved to detect fraudulent URLs without relying on paid services.
The focus was to strengthen detection with in-house code, local heuristics (PT/BR), and open public sources, while keeping full control of the pipeline.

Note: the CNPJ used in the examples was changed to 11917932300169.
The goal is to illustrate the case, not to expose real individuals or companies.


Note #2: CNPJ is the Brazilian business tax ID, similar to the EIN in the U.S."><meta property="og:url" content="https://adlermedrado.com.br/posts/hades-evolution/"><meta property="og:site_name" content="Adler Medrado's corner of the web"><meta property="og:type" content="article"><meta property="og:image" content="https://adlermedrado.com.br/images/fraudtalon-preview.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Evolving HADES"><meta name=twitter:description content="This post describes how HADES evolved to detect fraudulent URLs without relying on paid services.
The focus was to strengthen detection with in-house code, local heuristics (PT/BR), and open public sources, while keeping full control of the pipeline.

Note: the CNPJ used in the examples was changed to 11917932300169.
The goal is to illustrate the case, not to expose real individuals or companies.


Note #2: CNPJ is the Brazilian business tax ID, similar to the EIN in the U.S."><meta name=twitter:image content="https://adlermedrado.com.br/images/fraudtalon-preview.png"><title>Evolving HADES</title><meta name=description content="This post describes how HADES evolved to detect fraudulent URLs without relying on paid services.
The focus was to strengthen detection with in-house code, local heuristics (PT/BR), and open public sources, while keeping full control of the pipeline.

Note: the CNPJ used in the examples was changed to 11917932300169.
The goal is to illustrate the case, not to expose real individuals or companies.


Note #2: CNPJ is the Brazilian business tax ID, similar to the EIN in the U.S."><meta name=keywords content="AI fraud detection,cybersecurity Brazil,spacexnu,Adler Medrado,FraudTalon,digital sovereignty,threat intelligence,Python,Go,Rust,security engineering"><link rel=author href=/humans.txt><link rel=icon type=image/png href=/images/favicon.png><link rel=canonical href=https://adlermedrado.com.br/posts/hades-evolution/><link rel=alternate type=application/rss+xml title="Adler Medrado's corner of the web" href=/index.xml><link href=/css/styles.css rel=stylesheet></head><body><header class=glitch-zone><nav class=navbar role=navigation aria-label="Main Navigation"><div class=navbar_left><a href=/ class=h-card rel=me><strong>Adler Medrado<span class=cursor-blink>|</span></strong></a></div><div class="navbar_right navbar_right_animated"><a href=/about>about</a>
<a href=/projects>projects</a>
<a href=/posts>posts</a>
<a href=/missives>missives</a>
<a href=/now>what am i doing now</a>
<a href=/uses>what am i using</a>
<a href=/contact>contact</a>
<a href=/index.xml aria-label="RSS feed">rss</a></div></nav></header><main><section class=section><article><div><h1>Evolving HADES</h1><div><div><p><small><time>January 4, 2026</time>
|
4 minutes read</small><div class=post-tags><p><strong>Tags:</strong>
<a href=/tags/security>security</a>,
<a href=/tags/fraud>fraud</a>,
<a href=/tags/detection>detection</a></p></div></p></div><span class=line_break></span></div><div class=content><p>This post describes how <strong>HADES</strong> evolved to detect fraudulent URLs <strong>without relying on paid services</strong>.<br>The focus was to strengthen detection with <strong>in-house code</strong>, <strong>local heuristics (PT/BR)</strong>, and <strong>open public sources</strong>, while keeping full control of the pipeline.</p><blockquote><p><strong>Note:</strong> the CNPJ used in the examples was changed to <code>11917932300169</code>.<br>The goal is to <strong>illustrate the case</strong>, not to expose real individuals or companies.</p></blockquote><blockquote><p><strong>Note #2</strong>: CNPJ is the Brazilian business tax ID, similar to the EIN in the U.S.</p></blockquote><hr><h2 id=1-initial-problem-simple-heuristics-fail-on-local-scams>1) Initial problem: simple heuristics fail on local scams</h2><p>HADES used simple rules: suspicious English words (<code>login/verify</code>), HTTP without TLS, IP in the URL, excessive subdomains, and recently registered domains.<br>Those rules work for didactic examples, but fail with Brazilian scams.</p><p><strong>Real example that passed with score 0:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>https://pagmei.regularizareimediato.com/11917932300169
</span></span></code></pre></div><p><strong>Reasons:</strong></p><ul><li>No &ldquo;login/verify&rdquo; words in English.</li><li>HTML did not trigger heuristics.</li><li>No rule captured CNPJ/CPF in the path.</li></ul><p>The system was <strong>blind</strong> to the Brazilian scenario.</p><hr><h2 id=2-local-heuristics-ptbr--recurring-scam-patterns>2) Local heuristics (PT/BR) + recurring scam patterns</h2><h3 id=improvements>Improvements</h3><ul><li>Separate PT and EN dictionaries (e.g., <code>pagamento</code>, <code>boleto</code>, <code>pix</code>, <code>cnpj</code>, <code>cpf</code>, <code>regulariza</code>).</li><li>Detection of <strong>long numeric path</strong> (e.g., <code>/11917932300169</code>).</li><li>Penalty for <strong>long domains</strong>, common in phishing (fake branding, multiple words, etc.).</li></ul><h3 id=benefits>Benefits</h3><ul><li>National scams do not use &ldquo;verify/login&rdquo; in English.</li><li>CNPJ/CPF in the path is a standard pattern in billing scams.</li><li>Long domains increase risk (attempt to look &ldquo;official&rdquo; via text).</li></ul><h3 id=example-before>Example (before)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>POST /analyze
</span></span><span style=display:flex><span>Content-Type: application/json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;urls&#34;</span>: <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;https://pagmei.regularizareimediato.com/11917932300169&#34;</span><span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>Response:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-json data-lang=json><span style=display:flex><span>[
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;url&#34;</span>: <span style=color:#e6db74>&#34;https://pagmei.regularizareimediato.com/11917932300169&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;score&#34;</span>: <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;url_details&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;domain_length&#34;</span>: <span style=color:#ae81ff>31</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;url_length&#34;</span>: <span style=color:#ae81ff>54</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;has_suspicious_words&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;num_subdomains&#34;</span>: <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;uses_ip_address&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;uses_insecure_protocol&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;domain_age_days&#34;</span>: <span style=color:#ae81ff>-1</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;html_details&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;content_fetched&#34;</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;has_suspicious_title&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;has_phishing_keywords&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;has_suspicious_forms&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;has_external_redirects&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;has_obfuscated_code&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;missing_ssl_indicators&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;html_score&#34;</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;final_score&#34;</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><h3 id=example-after-local-heuristics-only>Example (after, local heuristics only)</h3><p>Response (real example):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-json data-lang=json><span style=display:flex><span>[
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;url&#34;</span>: <span style=color:#e6db74>&#34;https://pagmei.regularizareimediato.com/11917932300169&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;score&#34;</span>: <span style=color:#ae81ff>50</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;url_details&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;domain_length&#34;</span>: <span style=color:#ae81ff>31</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;url_length&#34;</span>: <span style=color:#ae81ff>54</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;has_suspicious_words&#34;</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;has_long_numeric_path&#34;</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;in_feed_blocklist&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;feed_match_type&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;num_subdomains&#34;</span>: <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;uses_ip_address&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;uses_insecure_protocol&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;domain_age_days&#34;</span>: <span style=color:#ae81ff>-1</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;html_details&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;content_fetched&#34;</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;has_suspicious_title&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;has_phishing_keywords&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;has_suspicious_forms&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;has_external_redirects&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;has_obfuscated_code&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;missing_ssl_indicators&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;html_score&#34;</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;final_score&#34;</span>: <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><hr><h2 id=3-dictionary-in-the-database--moderation-the-system-learns-without-redeploy>3) Dictionary in the database + moderation (the system learns without redeploy)</h2><h3 id=what-was-done-dictionary-in-the-database>What was done (dictionary in the database)</h3><ul><li>Created the <code>suspicious_dictionary</code> table.</li><li>Each term has a <code>status</code> (e.g., <code>approved</code>, <code>awaiting_moderation</code>).</li><li>The code fetches words from the database.</li><li>New terms from suspicious URLs are saved as <strong>candidates</strong> (<code>awaiting_moderation</code>).</li></ul><h3 id=why-this-helps-dictionary-in-the-database>Why this helps (dictionary in the database)</h3><ul><li>No need to rewrite code to adjust the dictionary.</li><li>The system suggests new scam terms.</li><li>The team decides what to approve, avoiding noise and false positives.</li></ul><p><strong>Practical example:</strong></p><ul><li>The domain <code>regularizareimediato.com</code> yields tokens like <code>regulariza</code>, <code>imediato</code>.</li><li>They go to review and can become official rules.</li></ul><hr><h2 id=4-local-reputation-with-open-blocklists-no-cost-no-signup>4) Local reputation with open blocklists (no cost, no signup)</h2><p>Heuristics do not detect known malicious URLs. We need reputation without paid services.</p><h3 id=what-was-done-open-blocklists>What was done (open blocklists)</h3><ul><li>Created <code>feed_sources</code> and <code>feed_entries</code> tables.</li><li>Ingestion pipeline to download open public lists (no signup):<ul><li>Phishing.Database (ACTIVE + NEW - &ldquo;today&rdquo;)</li><li>OpenPhish public feed (via GitHub)</li><li>Spam404</li><li>KADhosts</li></ul></li><li>Normalization and batch save.</li></ul><h3 id=why-this-helps-open-blocklists>Why this helps (open blocklists)</h3><ul><li>Known malicious URLs or domains receive <strong>immediate high risk</strong>.</li><li>Lists cover real campaigns and are updated daily.</li><li>No cost.</li></ul><hr><h2 id=5-score-integration-blocklist-becomes-a-strong-signal>5) Score integration (blocklist becomes a strong signal)</h2><h3 id=what-was-done-score-integration>What was done (score integration)</h3><ul><li>During analysis, the system queries the database:<ul><li>Full URL (direct match)</li><li>Domain and subdomains</li></ul></li><li>A match sets:<ul><li><code>in_feed_blocklist = true</code></li><li><code>feed_match_type = url | domain</code></li></ul></li><li>Adds <strong>+200</strong> to the score: high risk.</li></ul><h3 id=example-url-in-blocklist>Example (URL in blocklist)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>in_feed_blocklist: true
</span></span><span style=display:flex><span>feed_match_type: url (or domain)
</span></span><span style=display:flex><span>score &gt;= 200
</span></span><span style=display:flex><span>final_score high
</span></span></code></pre></div><h3 id=why-this-helps-score-integration>Why this helps (score integration)</h3><ul><li>Score reflects fraud immediately.</li><li>Avoids &ldquo;false negatives&rdquo; for URLs already known as scams.</li></ul><hr><h2 id=operational-pipeline-production-without-pain>Operational pipeline: production without pain</h2><h3 id=what-was-done-operational-pipeline>What was done (operational pipeline)</h3><ul><li><code>cmd/ingest</code> binary (runs once or in a loop).</li><li><code>ingest</code> service in Docker Compose (<code>INGEST_INTERVAL</code>).</li><li>Makefile:<ul><li><code>make ingest</code></li><li><code>make ingest-loop</code></li></ul></li></ul><h3 id=example-local-ingestion>Example (local ingestion)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>make migrate-up
</span></span><span style=display:flex><span>make ingest
</span></span></code></pre></div><h3 id=example-continuous-ingestion-via-docker>Example (continuous ingestion via Docker)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>docker compose up -d ingest
</span></span></code></pre></div><h3 id=why-this-helps-operational-pipeline>Why this helps (operational pipeline)</h3><ul><li>Automated pipeline.</li><li>Independent of external installs.</li><li>Control over the update interval.</li></ul><hr><h2 id=before-and-after>Before and after</h2><p><strong>Before</strong> (fraudulent URL passed):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>score: 0
</span></span><span style=display:flex><span>has_suspicious_words: false
</span></span><span style=display:flex><span>html_score: 0
</span></span></code></pre></div><p><strong>After</strong> (local heuristics + blocklist):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>score &gt; 0
</span></span><span style=display:flex><span>has_suspicious_words: true
</span></span><span style=display:flex><span>has_long_numeric_path: true
</span></span><span style=display:flex><span>in_feed_blocklist: true (if the feed has the URL/domain)
</span></span></code></pre></div><hr><h2 id=next-steps>Next steps</h2><ul><li><strong>Benign lists (top-1M):</strong> reduce false positives.</li><li><strong>Lightweight ML model:</strong> logistic regression / random forest.</li><li><strong>Advanced normalization:</strong> punycode, homoglyphs.</li></ul><hr><p>HADES evolved from a simple model into a realistic detector, with a moderated dynamic dictionary, local heuristics (PT/BR), reputation based on public feeds, and an automated ingestion pipeline, still without relying on paid services.</p><p>If you are interested, the code is updated on <a href=https://github.com/spacexnu/hades>GitHub</a>.</p></div></div></article><div><div><div><a href=https://adlermedrado.com.br/posts/meu-site-disponivel-via-rede-tor/>&#8592; Meu site agora est√° dispon√≠vel via rede Tor</a>
|
<a href=https://adlermedrado.com.br/posts/evolucao-hades/>Evoluindo o HADES &#8594;</a></div></div></div></section></main><footer class=glitch-zone role=contentinfo><div class=footer-content><div class=copyright><p><small>&copy; 1996-2026 Adler Medrado</small></p></div><div class=gpg_signed_info><div class=gpg-callout><div class=gpg-callout__icon aria-hidden=true>üîè</div><div class=gpg-callout__text><p class=gpg-callout__title>All pages are PGP signed.</p><p class=gpg-callout__subtitle>Learn how to verify my PGP signature <a class=gpg-callout__link href=/posts/verify-signatures>here</a>.</p></div></div><p><em>Privacy policy: this website employs no tracking.</em></p><p><span class=badge-a-plus><a href="https://developer.mozilla.org/en-US/observatory/analyze?host=adlermedrado.com.br" aria-label="Mozilla Observatory Security Rating: A+">A+</a></span>
<span class=badge-description>Mozilla Observatory Security Rating</span></p></div></div></footer></body></html>