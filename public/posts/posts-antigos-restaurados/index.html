<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="Posts antigos restaurados"><meta property="og:description" content="√â muito legal ser programador e participar de projetos com as mais variadas dimens√µes e complexidades, mas uma das
coisas que eu acho mais legal em ser um programador √© o fato de poder utilizar este conhecimento para automatizar
tarefas e resolver problemas do cotidiano.
Resolvi escrever este post justamente porque eu automatizei uma tarefa que me tomaria algumas horas com um pequeno e
simples script python.
Eu achei legal escrever um pouco sobre isso porque pode servir de exemplo para pessoas que n√£o trabalham com programa√ß√£o
diariamente de que elas podem se beneficiar em conhecer um pouco e tentar otimizar tarefas repetitivas."><meta property="og:url" content="https://adlermedrado.com.br/posts/posts-antigos-restaurados/"><meta property="og:site_name" content="Adler Medrado's corner of the web"><meta property="og:type" content="article"><meta property="og:image" content="https://adlermedrado.com.br/images/fraudtalon-preview.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Posts antigos restaurados"><meta name=twitter:description content="√â muito legal ser programador e participar de projetos com as mais variadas dimens√µes e complexidades, mas uma das
coisas que eu acho mais legal em ser um programador √© o fato de poder utilizar este conhecimento para automatizar
tarefas e resolver problemas do cotidiano.
Resolvi escrever este post justamente porque eu automatizei uma tarefa que me tomaria algumas horas com um pequeno e
simples script python.
Eu achei legal escrever um pouco sobre isso porque pode servir de exemplo para pessoas que n√£o trabalham com programa√ß√£o
diariamente de que elas podem se beneficiar em conhecer um pouco e tentar otimizar tarefas repetitivas."><meta name=twitter:image content="https://adlermedrado.com.br/images/fraudtalon-preview.png"><title>Posts antigos restaurados</title><meta name=description content="√â muito legal ser programador e participar de projetos com as mais variadas dimens√µes e complexidades, mas uma das
coisas que eu acho mais legal em ser um programador √© o fato de poder utilizar este conhecimento para automatizar
tarefas e resolver problemas do cotidiano.
Resolvi escrever este post justamente porque eu automatizei uma tarefa que me tomaria algumas horas com um pequeno e
simples script python.
Eu achei legal escrever um pouco sobre isso porque pode servir de exemplo para pessoas que n√£o trabalham com programa√ß√£o
diariamente de que elas podem se beneficiar em conhecer um pouco e tentar otimizar tarefas repetitivas."><meta name=keywords content="AI fraud detection,cybersecurity Brazil,spacexnu,Adler Medrado,FraudTalon,digital sovereignty,threat intelligence,Python,Go,Rust,security engineering"><link rel=author href=/humans.txt><link rel=icon type=image/png href=/images/favicon.png><link rel=canonical href=https://adlermedrado.com.br/posts/posts-antigos-restaurados/><link rel=alternate type=application/rss+xml title="Adler Medrado's corner of the web" href=/index.xml><link href=/css/styles.css rel=stylesheet></head><body><header class=glitch-zone><nav class=navbar role=navigation aria-label="Main Navigation"><div class=navbar_left><a href=/ class=h-card rel=me><strong>Adler Medrado<span class=cursor-blink>|</span></strong></a></div><div class="navbar_right navbar_right_animated"><a href=/about>about</a>
<a href=/projects>projects</a>
<a href=/posts>posts</a>
<a href=/missives>missives</a>
<a href=/now>what am i doing now</a>
<a href=/uses>what am i using</a>
<a href=/contact>contact</a>
<a href=/index.xml aria-label="RSS feed">rss</a></div></nav></header><main><section class=section><article><div><h1>Posts antigos restaurados</h1><div><div><p><small><time>December 31, 2017</time>
|
4 minutes read</small><div class=post-tags><p><strong>Tags:</strong>
<a href=/tags/development>development</a>,
<a href=/tags/python>python</a></p></div></p></div><span class=line_break></span></div><div class=content><p>√â muito legal ser programador e participar de projetos com as mais variadas dimens√µes e complexidades, mas uma das
coisas que eu acho mais legal em ser um programador √© o fato de poder utilizar este conhecimento para automatizar
tarefas e resolver problemas do cotidiano.</p><p>Resolvi escrever este post justamente porque eu automatizei uma tarefa que me tomaria algumas horas com um pequeno e
simples script <a href=https://www.python.org/>python</a>.</p><p>Eu achei legal escrever um pouco sobre isso porque pode servir de exemplo para pessoas que n√£o trabalham com programa√ß√£o
diariamente de que elas podem se beneficiar em conhecer um pouco e tentar otimizar tarefas repetitivas.</p><h3 id=contextualizando>Contextualizando</h3><p><a href=https://github.com/adlermedrado-archive/dangolino>No in√≠cio de 2012 eu implementei um projeto pessoal para poder gerar meu blog com p√°ginas est√°ticas</a>,
estilo Jekyl, Pelican, etc., mas muito mais simples pois foi feito para atender somente as minhas necessidades.</p><p>Eu implementei tamb√©m um pequeno importador para converter meu blog <a href=https://wordpress.com/>wordpress</a> neste novo
formato. Tudo funcionou legal, e usei durante um bom tempo, mas passaram-se uns anos e eu precisei trocar de computador
e achei um saco atualizar todas as libs necess√°rias para o projeto funcionar, ent√£o eu voltei para o wordpress.</p><p>Quando eu voltei ao Wordpress eu deixei alguns desses posts antigos para tr√°s, n√£o os publiquei novamente e eles ficaram
num backup para at√© um dia em que eu tivesse paci√™ncia, publica-los novamente. E ent√£o passaram-se alguns anos.</p><p>Recentemente eu passei a utilizar o <a href=https://blog.getpelican.com/>pelican</a>, que √© um gerador de sites est√°ticos e ontem
eu me lembrei dos posts antigos que estavam nos meus backups e decidi que era a oportunidade de importa-los novamente.</p><p>O problemas √© que isso me daria muito trabalho, e uma das coisas que programador menos gosta √© de ficar fazendo trabalho
bra√ßal, ent√£o, tentei automatizar o processo.</p><h3 id=a-solu√ß√£o>A solu√ß√£o</h3><p>Exisitiam em torno de 200 posts, imagina copiar isso um a um manualmente, editar e salvar no formato do Pelican no
diret√≥rio correto? <em>No way</em>.</p><p>A primeira coisa que eu fiz foi analisar se quando eu gerei os arquivos est√°ticos (HTML), eu o fiz deixando-os
padronizados, mas nem todos estavam dentro do mesmo padr√£o. <em>Shame on me</em>, li√ß√£o aprendida, bola pra frente.</p><p>Eu salvei todos os arquivos HTML em um diret√≥rio chamado <em>old</em> e os posts estavam salvos da seguinte maneira:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>| |<span style=color:#ae81ff>\_\_\_\_</span><span style=color:#ae81ff>2010</span>   
</span></span><span style=display:flex><span>| | |<span style=color:#ae81ff>\_\_\_\_</span><span style=color:#ae81ff>04</span>   
</span></span><span style=display:flex><span>| | | |<span style=color:#ae81ff>\_\_\_\_</span>arquivos html
</span></span></code></pre></div><p><br>N√£o coloquei toda a √°rvore aqui para n√£o ficar muito grande, mas basicamente os arquivos estavam agrupados por <strong>ANO</strong> e <strong>M√äS</strong>, ent√£o para processa-los eu precisei iterar no diret√≥rio <em>old</em> e seus subdiret√≥rios:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#66d9ef>for</span> subdir, dirs, files in os.walk<span style=color:#f92672>(</span>content<span style=color:#ae81ff>\_</span>root<span style=color:#f92672>)</span>:   
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> file in files: <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;images&#39;</span> not in subdir:   
</span></span><span style=display:flex><span>with open<span style=color:#f92672>(</span>file<span style=color:#ae81ff>\_</span>path, <span style=color:#e6db74>&#39;r&#39;</span><span style=color:#f92672>)</span> as content<span style=color:#ae81ff>\_</span>file:   
</span></span></code></pre></div><p>O diret√≥rio <em>old</em> tem um subdiret√≥rio chamado images e eu n√£o processei o que tinha dentro dele justamente por s√≥ conter
imagens.</p><p>O pr√≥ximo passo foi fazer o parse do HTML para poder trabalhar com o texto, para isso eu usei a biblioteca
BeautifoulSoup:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>extract_data</span>():   
</span></span><span style=display:flex><span>    content <span style=color:#f92672>=</span> content_file<span style=color:#f92672>.</span>read()   
</span></span><span style=display:flex><span>    soup <span style=color:#f92672>=</span> BeautifulSoup(content, <span style=color:#e6db74>&#34;html.parser&#34;</span>)   
</span></span><span style=display:flex><span>    post_title <span style=color:#f92672>=</span> soup<span style=color:#f92672>.</span>html<span style=color:#f92672>.</span>body<span style=color:#f92672>.</span>h1<span style=color:#f92672>.</span>text   
</span></span><span style=display:flex><span>    post_content\_data <span style=color:#f92672>=</span> soup<span style=color:#f92672>.</span>findAll(<span style=color:#e6db74>&#39;div&#39;</span>, {<span style=color:#e6db74>&#39;class&#39;</span>: <span style=color:#e6db74>&#39;span12&#39;</span>})\[<span style=color:#ae81ff>1</span>\]  
</span></span><span style=display:flex><span>    post_date <span style=color:#f92672>=</span> post\_content\_data<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#39;p&#39;</span>)<span style=color:#f92672>.</span>text<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;Post date:&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>)<span style=color:#f92672>.</span>strip()   
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> post_date:   
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>ValueError</span>(<span style=color:#e6db74>&#34;Post date not found&#34;</span>)   
</span></span><span style=display:flex><span>        post_content <span style=color:#f92672>=</span> post\_content\_data<span style=color:#f92672>.</span>text<span style=color:#f92672>.</span>strip()   
</span></span><span style=display:flex><span>        post_content <span style=color:#f92672>=</span> re<span style=color:#f92672>.</span>sub(<span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;Post date: (d+/d+/d+)&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>, post\_content)   
</span></span><span style=display:flex><span>        post_content <span style=color:#f92672>=</span> re<span style=color:#f92672>.</span>sub(<span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;- (d+:d+:d+)&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>, post\_content)  
</span></span><span style=display:flex><span>        post_slug <span style=color:#f92672>=</span> file<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;.html&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {   
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;post_title&#39;</span>: replace\_invalid\_chars(post\_title),  
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;post_date&#39;</span>: post\_date, <span style=color:#e6db74>&#39;post\_content&#39;</span>: replace\_invalid\_chars(post\_content),   
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;post_slug&#39;</span>: replace\_invalid\_chars(post\_slug),   
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><p>Esta fun√ß√£o basicamente obtinha as informa√ß√µes do post que eu precisava (titulo, data, slug e conte√∫do) e fazia alguns
tratamentos nestes dados, porque eu n√£o me lembro o motivo, mas muitos caracteres estavam incorretos.</p><p>Eu tamb√©m removi trechos de texto desnecess√°rios, removi espa√ßos em branco das extremidades e coisas simples assim, essa
fun√ß√£o retorna um dicion√°rio com as informa√ß√µes necess√°rias para salvar o novo arquivo.</p><p>Na sequ√™ncia eu uma fun√ß√£o que criava o novo arquivo markdown, adicionava nele o conte√∫do no formato do Pelican e o
salva:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>convert_to_new_post</span>(post_contents):   
</span></span><span style=display:flex><span>    info_message <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;**AVISO:** _Este post √© muito antigo e seu conte√∫do provavelmente est√° defasado, permanecendo</span>
</span></span><span style=display:flex><span>    no meu blog apenas por motivos hist√≥ricos<span style=color:#f92672>.</span>_<span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    new_post_file <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;converted/</span><span style=color:#e6db74>{</span>post_contents<span style=color:#960050;background-color:#1e0010>\</span>[<span style=color:#e6db74>&#39;post_slug&#39;</span><span style=color:#960050;background-color:#1e0010>\</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>.md&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    new_post <span style=color:#f92672>=</span> open(new_post_file, <span style=color:#e6db74>&#39;w&#39;</span>)   
</span></span><span style=display:flex><span>    new_post<span style=color:#f92672>.</span>write(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Title: </span><span style=color:#e6db74>{</span>post_contents<span style=color:#960050;background-color:#1e0010>\</span>[<span style=color:#e6db74>&#39;post_title&#39;</span><span style=color:#960050;background-color:#1e0010>\</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)  
</span></span><span style=display:flex><span>    new_post<span style=color:#f92672>.</span>write(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Date: </span><span style=color:#e6db74>{</span>post_contents<span style=color:#960050;background-color:#1e0010>\</span>[<span style=color:#e6db74>&#39;post_date&#39;</span><span style=color:#960050;background-color:#1e0010>\</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)  
</span></span><span style=display:flex><span>    new_post<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;Author: adlern&#34;</span>) new_post<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;Tags: old&#34;</span>)  
</span></span><span style=display:flex><span>    new_post<span style=color:#f92672>.</span>write(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Slug: </span><span style=color:#e6db74>{</span>post_contents<span style=color:#960050;background-color:#1e0010>\</span>[<span style=color:#e6db74>&#39;post_slug&#39;</span><span style=color:#960050;background-color:#1e0010>\</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)  
</span></span><span style=display:flex><span>    new_post<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;Status: published&#34;</span>)   
</span></span><span style=display:flex><span>    new_post<span style=color:#f92672>.</span>write(info_message <span style=color:#f92672>+</span> post_contents[<span style=color:#e6db74>&#39;post_content&#39;</span>])  
</span></span><span style=display:flex><span>    new_post<span style=color:#f92672>.</span>close()
</span></span></code></pre></div><h3 id=nem-todos-os-posts-foram-importados>Nem todos os posts foram importados</h3><p>No final eu descartei alguns posts pois eles eram contextualmente irrelevantes para o site, e apesar de eu n√£o gostar de
jogar hist√≥ria fora, aqueles eram t√£o bobinhos que sinceramente, n√£o far√£o muita falta.</p><p>Mas eles est√£o salvos aqui, para caso eu mude de id√©ia algum dia.</p><h3 id=c√≥digo-completo-e-considera√ß√µes-finais>C√≥digo completo e considera√ß√µes finais</h3><p>Se eu n√£o tivesse criado este script eu teria que fazer esse processo manualmente em duas centenas de arquivos e
certamente n√£o seria algo agrad√°vel e eu levei algo em torno de 30 minutos para escreve-lo.</p><p>O c√≥digo completo est√° <a href=https://gist.github.com/adlermedrado/6159cbf6b3fcca2473c175816f7ff94f>salvo em um Gist</a> a quem
interessar possa.</p></div></div></article><div><div><div><a href=https://adlermedrado.com.br/posts/do-php-ao-python/>&#8592; Do PHP ao Python</a>
|
<a href=https://adlermedrado.com.br/posts/enabling-click-and-drag-on-macbook/>Enabling Click and Drag on MacBook &#8594;</a></div></div></div></section></main><footer class=glitch-zone role=contentinfo><div class=footer-content><div class=copyright><p><small>&copy; 1996-2026 Adler Medrado</small></p></div><div class=gpg_signed_info><div class=gpg-callout><div class=gpg-callout__icon aria-hidden=true>üîè</div><div class=gpg-callout__text><p class=gpg-callout__title>All pages are PGP signed.</p><p class=gpg-callout__subtitle>Learn how to verify my PGP signature <a class=gpg-callout__link href=/posts/verify-signatures>here</a>.</p></div></div><p><em>Privacy policy: this website employs no tracking.</em></p><p><span class=badge-a-plus><a href="https://developer.mozilla.org/en-US/observatory/analyze?host=adlermedrado.com.br" aria-label="Mozilla Observatory Security Rating: A+">A+</a></span>
<span class=badge-description>Mozilla Observatory Security Rating</span></p></div></div></footer></body></html>