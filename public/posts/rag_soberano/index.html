<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="Como constru√≠ meu pr√≥prio RAG soberano para an√°lise de seguran√ßa de c√≥digo"><meta property="og:description" content="Construindo meu pr√≥prio RAG soberano para an√°lise de seguran√ßa de c√≥digo
Nos √∫ltimos tempos, comecei a olhar com mais aten√ß√£o para algumas ferramentas de an√°lise de c√≥digo que prometem identificar falhas de seguran√ßa em projetos. A ideia √© boa. Recebi uma dessas ferramentas como sugest√£o e fui atr√°s para entender melhor o que havia por tr√°s da proposta.
Logo de cara percebi um padr√£o: os pre√ßos dessas plataformas n√£o s√£o exatamente convidativos. Algumas at√© oferecem planos gratuitos limitados, mas a gente sabe como funciona o jogo. Quando algo muito bom aparece ‚Äúde gra√ßa‚Äù, o custo real costuma vir de outro lugar. Coleta de dados, lock-in na plataforma, modelos black-box processando seu c√≥digo na nuvem de terceiros. E como hoje eu venho estudando bastante IA e, em especial, o tema dos RAGs (Retrieval-Augmented Generation), a pergunta veio autom√°tica: por que n√£o montar o meu pr√≥prio pipeline, 100% local, soberano, usando ferramentas open-source, rodando direto na minha m√°quina, sem depender de ningu√©m?"><meta property="og:url" content="http://xlqlev6ixhge3wyoivxhpcvuv2v5it2m2dxjnfng5d66jb7c6kpv6qid.onion/posts/rag_soberano/"><meta property="og:site_name" content="Adler Medrado's corner of the web"><meta property="og:type" content="article"><meta property="og:image" content="http://xlqlev6ixhge3wyoivxhpcvuv2v5it2m2dxjnfng5d66jb7c6kpv6qid.onion/images/fraudtalon-preview.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Como constru√≠ meu pr√≥prio RAG soberano para an√°lise de seguran√ßa de c√≥digo"><meta name=twitter:description content="Construindo meu pr√≥prio RAG soberano para an√°lise de seguran√ßa de c√≥digo
Nos √∫ltimos tempos, comecei a olhar com mais aten√ß√£o para algumas ferramentas de an√°lise de c√≥digo que prometem identificar falhas de seguran√ßa em projetos. A ideia √© boa. Recebi uma dessas ferramentas como sugest√£o e fui atr√°s para entender melhor o que havia por tr√°s da proposta.
Logo de cara percebi um padr√£o: os pre√ßos dessas plataformas n√£o s√£o exatamente convidativos. Algumas at√© oferecem planos gratuitos limitados, mas a gente sabe como funciona o jogo. Quando algo muito bom aparece ‚Äúde gra√ßa‚Äù, o custo real costuma vir de outro lugar. Coleta de dados, lock-in na plataforma, modelos black-box processando seu c√≥digo na nuvem de terceiros. E como hoje eu venho estudando bastante IA e, em especial, o tema dos RAGs (Retrieval-Augmented Generation), a pergunta veio autom√°tica: por que n√£o montar o meu pr√≥prio pipeline, 100% local, soberano, usando ferramentas open-source, rodando direto na minha m√°quina, sem depender de ningu√©m?"><meta name=twitter:image content="http://xlqlev6ixhge3wyoivxhpcvuv2v5it2m2dxjnfng5d66jb7c6kpv6qid.onion/images/fraudtalon-preview.png"><title>Como constru√≠ meu pr√≥prio RAG soberano para an√°lise de seguran√ßa de c√≥digo</title><meta name=description content="Construindo meu pr√≥prio RAG soberano para an√°lise de seguran√ßa de c√≥digo
Nos √∫ltimos tempos, comecei a olhar com mais aten√ß√£o para algumas ferramentas de an√°lise de c√≥digo que prometem identificar falhas de seguran√ßa em projetos. A ideia √© boa. Recebi uma dessas ferramentas como sugest√£o e fui atr√°s para entender melhor o que havia por tr√°s da proposta.
Logo de cara percebi um padr√£o: os pre√ßos dessas plataformas n√£o s√£o exatamente convidativos. Algumas at√© oferecem planos gratuitos limitados, mas a gente sabe como funciona o jogo. Quando algo muito bom aparece ‚Äúde gra√ßa‚Äù, o custo real costuma vir de outro lugar. Coleta de dados, lock-in na plataforma, modelos black-box processando seu c√≥digo na nuvem de terceiros. E como hoje eu venho estudando bastante IA e, em especial, o tema dos RAGs (Retrieval-Augmented Generation), a pergunta veio autom√°tica: por que n√£o montar o meu pr√≥prio pipeline, 100% local, soberano, usando ferramentas open-source, rodando direto na minha m√°quina, sem depender de ningu√©m?"><meta name=keywords content="AI fraud detection,cybersecurity Brazil,spacexnu,Adler Medrado,FraudTalon,digital sovereignty,threat intelligence,Python,Go,Rust,security engineering"><link rel=author href=../../humans.txt><link rel=icon type=image/png href=../../images/favicon.png><link rel=canonical href=http://xlqlev6ixhge3wyoivxhpcvuv2v5it2m2dxjnfng5d66jb7c6kpv6qid.onion/posts/rag_soberano/><link rel=alternate type=application/rss+xml title="Adler Medrado's corner of the web" href=../../index.xml><link href=../../css/styles.css rel=stylesheet></head><body><header class=glitch-zone><nav class=navbar role=navigation aria-label="Main Navigation"><div class=navbar_left><a href=../../ class=h-card rel=me><strong>Adler Medrado<span class=cursor-blink>|</span></strong></a></div><div class="navbar_right navbar_right_animated"><a href=../../about>about</a>
<a href=../../projects>projects</a>
<a href=../../posts>posts</a>
<a href=../../missives>missives</a>
<a href=../../now>what am i doing now</a>
<a href=../../uses>what am i using</a>
<a href=../../contact>contact</a>
<a href=../../index.xml aria-label="RSS feed">rss</a></div></nav></header><main><section class=section><article><div><h1>Como constru√≠ meu pr√≥prio RAG soberano para an√°lise de seguran√ßa de c√≥digo</h1><div><div><p><small><time>June 14, 2025</time>
|
7 minutes read</small><div class=post-tags><p><strong>Tags:</strong>
<a href=../../tags/rag>rag</a>,
<a href=../../tags/ia>ia</a>,
<a href=../../tags/soberania>soberania</a>,
<a href=../../tags/ollama>ollama</a>,
<a href=../../tags/llm>llm</a>,
<a href=../../tags/seguranca>seguranca</a></p></div></p></div><span class=line_break></span></div><div class=content><h2 id=construindo-meu-pr√≥prio-rag-soberano-para-an√°lise-de-seguran√ßa-de-c√≥digo>Construindo meu pr√≥prio RAG soberano para an√°lise de seguran√ßa de c√≥digo</h2><p>Nos √∫ltimos tempos, comecei a olhar com mais aten√ß√£o para algumas ferramentas de an√°lise de c√≥digo que prometem identificar falhas de seguran√ßa em projetos. A ideia √© boa. Recebi uma dessas ferramentas como sugest√£o e fui atr√°s para entender melhor o que havia por tr√°s da proposta.</p><p>Logo de cara percebi um padr√£o: os pre√ßos dessas plataformas n√£o s√£o exatamente convidativos. Algumas at√© oferecem planos gratuitos limitados, mas a gente sabe como funciona o jogo. Quando algo muito bom aparece ‚Äúde gra√ßa‚Äù, o custo real costuma vir de outro lugar. Coleta de dados, lock-in na plataforma, modelos black-box processando seu c√≥digo na nuvem de terceiros. E como hoje eu venho estudando bastante IA e, em especial, o tema dos RAGs (Retrieval-Augmented Generation), a pergunta veio autom√°tica: por que n√£o montar o meu pr√≥prio pipeline, 100% local, soberano, usando ferramentas open-source, rodando direto na minha m√°quina, sem depender de ningu√©m?</p><p>Assim nasceu o <strong><a href=https://github.com/spacexnu/sovereign-rag>SovereignRAG</a></strong>.</p><h3 id=como-funciona>Como funciona</h3><p>A ideia b√°sica foi simples: alimentar o meu RAG com conhecimento t√©cnico s√≥lido vindo de fontes reconhecidas na √°rea de seguran√ßa. Fui direto em materiais como o OWASP Top 10, CWE, NIST e outras refer√™ncias do setor. A partir da√≠, montei a seguinte estrat√©gia:</p><ol><li>Coletar as fontes originais em PDF (OWASP Top 10, CWE, NIST, etc).</li><li>Criar um parser que faz a extra√ß√£o de texto desses PDFs. Para limpar o material, utilizei NLP com spaCy, removendo ru√≠dos e filtrando o que realmente interessava. O resultado desse processamento foi persistido no ChromaDB como banco vetorial.</li><li>Desenvolver um prompt espec√≠fico, j√° hardcoded inicialmente no projeto. O pr√≥ximo passo natural aqui √© tornar esse prompt din√¢mico, parametriz√°vel, para deixar a ferramenta mais flex√≠vel e adapt√°vel a diferentes contextos.</li><li>Como motor de linguagem, escolhi o Ollama rodando localmente com o modelo mistral:7b-instruct. N√£o √© um modelo gigantesco, mas tamb√©m n√£o √© t√£o limitado como o phi3-instruct que inicialmente testei. Dentro da limita√ß√£o de hardware, foi o melhor equil√≠brio que encontrei.</li></ol><p>Estou rodando tudo isso no meu MacBook Air M1 com 16GB de RAM. √â √≥bvio que o processo n√£o √© instant√¢neo. Infer√™ncia de LLM local consome CPU pesado, ainda mais quando come√ßa a trabalhar com inputs longos e contexto t√©cnico denso. Mas o ponto central do experimento foi provado: √© perfeitamente vi√°vel rodar um pipeline de RAG soberano, offline, mantendo meus dados sob controle total, sem enviar nada para nuvem de ningu√©m, e principalmente, sem pagar o pre√ßo absurdo dessas solu√ß√µes SaaS ‚Äúinteligentes‚Äù que est√£o pipocando por a√≠.</p><p>Tenho v√°rias melhorias mapeadas na minha cabe√ßa. Paralelismo n√£o est√° nos planos por enquanto, justamente porque n√£o pretendo transformar o SSD do meu Mac em carv√£o swapando como se n√£o houvesse amanh√£.</p><h3 id=arquitetura-t√©cnica>Arquitetura T√©cnica</h3><p>Como a ideia sempre foi manter o controle completo do pipeline, a arquitetura do SovereignRAG foi montada de forma modular, com cada etapa bem definida e com ferramentas open-source que eu mesmo pudesse operar localmente. Nada de depend√™ncia de servi√ßos externos.</p><p>O pipeline ficou assim:</p><p><strong>1. Ingest√£o dos documentos de seguran√ßa</strong></p><p>A primeira etapa foi coletar e processar a base de conhecimento que alimentaria o RAG. Usei documentos oficiais de seguran√ßa no formato PDF, incluindo OWASP Top 10, CWE e NIST. Para extrair o conte√∫do relevante, utilizei o PyMuPDF para fazer o parsing dos PDFs e o spaCy para limpeza, tokeniza√ß√£o e remo√ß√£o de informa√ß√µes irrelevantes. Essa etapa √© importante porque qualquer ru√≠do desnecess√°rio impacta diretamente a qualidade dos embeddings gerados depois.</p><p><strong>2. Embeddings e indexa√ß√£o vetorial</strong></p><p>Com o conte√∫do limpo em m√£os, utilizei o modelo all-MiniLM-L6-v2 do SentenceTransformers para gerar os embeddings. Esses vetores foram armazenados no ChromaDB, um banco de dados vetorial leve e eficiente, que roda tranquilamente em m√°quina local sem exigir recursos absurdos.</p><p><strong>3. Query e an√°lise de c√≥digo</strong></p><p>No modo de an√°lise de c√≥digo, o pipeline l√™ o arquivo fonte, injeta o conte√∫do no prompt j√° pr√©-definido, recupera os documentos mais relevantes do banco vetorial (top_k controlado para n√£o sobrecarregar o modelo) e dispara a infer√™ncia.</p><p>A infer√™ncia roda localmente via Ollama, onde estou utilizando o modelo mistral:7b-instruct. Esse modelo foi o melhor equil√≠brio que encontrei entre capacidade de racioc√≠nio, suporte a contexto mais longo e viabilidade de rodar no hardware limitado que estou usando.</p><p><strong>4. Gera√ß√£o de relat√≥rio</strong></p><p>Para n√£o ficar apenas no terminal, decidi gerar relat√≥rios HTML com o resultado da an√°lise de cada arquivo. Assim, al√©m de permitir revisar o output com mais calma, tamb√©m j√° abro espa√ßo para no futuro transformar isso numa interface web mais organizada.</p><h3 id=desafios-limita√ß√µes-e-li√ß√µes-aprendidas>Desafios, Limita√ß√µes e Li√ß√µes Aprendidas</h3><p>Obviamente n√£o existe m√°gica nessa hist√≥ria. Rodar um pipeline de RAG local, offline e soberano, com an√°lise de c√≥digo em cima de bases complexas de seguran√ßa, tem um conjunto bem claro de desafios. N√£o √© o tipo de solu√ß√£o plug-and-play que os SaaS vendem, e tamb√©m n√£o √© para qualquer perfil t√©cnico.</p><p>O primeiro ponto que bate logo de cara √© o pr√≥prio hardware. Rodar LLMs exige processamento pesado. Estou rodando tudo isso num MacBook Air M1 com 16GB de RAM, que √© uma m√°quina excelente para muita coisa, mas est√° longe de ser um equipamento desenhado para processamento de infer√™ncia de IA em larga escala. Isso me for√ßou a tomar decis√µes bem pragm√°ticas desde o in√≠cio: processamento serial (um arquivo por vez), controle r√≠gido sobre o tamanho do contexto (top_k ajustado com cautela), chunking agressivo nos documentos durante a ingest√£o, e claro, nada de paralelismo. Paralelizar nesse contexto seria simplesmente suic√≠dio t√©rmico e desgaste desnecess√°rio do SSD swapando sem parar.</p><p>Outro desafio importante √© o pr√≥prio comportamento dos LLMs quando recebem contexto t√©cnico muito denso. Aprendi r√°pido que n√£o adianta simplesmente injetar documenta√ß√£o inteira e esperar que o modelo resolva tudo sozinho. Existe um trabalho delicado de engenharia de prompt aqui, para guiar o modelo na dire√ß√£o certa sem sobrecarregar o racioc√≠nio dele com ru√≠do desnecess√°rio.</p><p>Al√©m disso, o pr√≥prio balanceamento entre embedding de qualidade e performance de infer√™ncia local √© um ponto que exige testes pr√°ticos. O modelo MiniLM foi uma boa escolha inicial para gerar embeddings compactos e eficientes, mas j√° vejo espa√ßo para experimentar embeddings ainda mais otimizados no futuro (BGE, Instructor, etc).</p><p>Por fim, o mais √≥bvio de todos: velocidade. N√£o tem como rodar isso localmente e esperar tempos de resposta instant√¢neos, ainda mais com modelos de 7B. A cada an√°lise, √© preciso ter um pouco de paci√™ncia. N√£o √© o tipo de ferramenta para integrar num fluxo de CI/CD ainda, mas como laborat√≥rio e prova de conceito soberano, cumpre o seu papel com excel√™ncia.</p><img height=50% src=../../posts/images/sovereign-rag.png width=50%><h3 id=pr√≥ximos-passos-e-evolu√ß√£o-do-projeto>Pr√≥ximos passos e evolu√ß√£o do projeto</h3><p>O SovereignRAG nasceu como um laborat√≥rio, mas j√° come√ßa a apontar caminhos interessantes para expans√£o. A arquitetura atual √© funcional e cumpre bem o prop√≥sito de validar o conceito de RAG soberano aplicado √† seguran√ßa de c√≥digo, mas existem v√°rias camadas de melhorias que pretendo implementar nas pr√≥ximas etapas.</p><p>O primeiro ponto da lista √© refinar ainda mais o chunking durante a ingest√£o dos documentos. Esse √© um dos fatores mais cr√≠ticos na constru√ß√£o de qualquer pipeline de RAG. Chunk errado, contexto errado. Existe um trabalho fino aqui para encontrar o melhor equil√≠brio entre granularidade dos chunks, qualidade dos embeddings e capacidade de recall do vector store.</p><p>Outro ponto natural de evolu√ß√£o est√° nos pr√≥prios embeddings. Hoje estou usando o all-MiniLM-L6-v2 por uma quest√£o de leveza e viabilidade no meu ambiente atual, mas j√° estou de olho em modelos mais sofisticados como o BGE e o Instructor, que podem oferecer embeddings semanticamente mais precisos para o tipo de dado que estou trabalhando.</p><p>Do lado da infer√™ncia, h√° espa√ßo para experimentar outros modelos al√©m do mistral:7b-instruct. Eventualmente posso validar o Mixtral ou at√© mesmo trabalhar com quantiza√ß√µes otimizadas que permitam melhorar a performance no hardware limitado. Tamb√©m n√£o descarto no futuro montar um pequeno servidor soberano dedicado s√≥ para rodar esse tipo de workload de forma mais fluida, preservando o MacBook para as tarefas de desenvolvimento e produ√ß√£o de conte√∫do.</p><p>Outro objetivo de curto prazo √© tornar o pipeline um pouco mais flex√≠vel e parametriz√°vel. Hoje o prompt est√° hardcoded dentro do c√≥digo. A ideia √© abrir essa configura√ß√£o, permitir ajustes mais f√°ceis, talvez at√© implementar templates de an√°lise para diferentes tipos de projeto ou linguagem.</p><p>Por fim, o grande movimento de m√©dio prazo envolve transformar o que hoje √© um laborat√≥rio em um produto real. O SovereignRAG j√° serve de embri√£o para o que pode vir a ser o CodeTalon, um produto fechado, profissional, preparado para atuar em ambientes de seguran√ßa corporativa com an√°lise de c√≥digo soberana, offline e privada, sem depender de APIs de terceiros, nuvens obscuras ou SaaS engessados.</p><p>O conceito est√° plantado. Agora √© seguir no aprimoramento t√©cnico e deixar a m√°quina cada vez mais afiada.</p><p><img src=../../posts/images/sovereign-rag-faster.gif alt=gif-version-of-video-running-the-rag></p></div></div></article><div><div><div><a href=http://xlqlev6ixhge3wyoivxhpcvuv2v5it2m2dxjnfng5d66jb7c6kpv6qid.onion/posts/deepfakes_realtime/>&#8592; Real-time Deepfakes: what if "seeing is believing" no longer means anything?</a>
|
<a href=http://xlqlev6ixhge3wyoivxhpcvuv2v5it2m2dxjnfng5d66jb7c6kpv6qid.onion/posts/sovereign-rag/>Building My Own Sovereign RAG for Secure Code Analysis &#8594;</a></div></div></div></section></main><footer class=glitch-zone role=contentinfo><div class=footer-content><div class=copyright><p><small>&copy; 1996-2026 Adler Medrado</small></p></div><div class=gpg_signed_info><div class=gpg-callout><div class=gpg-callout__icon aria-hidden=true>üîè</div><div class=gpg-callout__text><p class=gpg-callout__title>All pages are PGP signed.</p><p class=gpg-callout__subtitle>Learn how to verify my PGP signature <a class=gpg-callout__link href=../../posts/verify-signatures>here</a>.</p></div></div><p><em>Privacy policy: this website employs no tracking.</em></p><p><span class=badge-a-plus><a href="https://developer.mozilla.org/en-US/observatory/analyze?host=adlermedrado.com.br" aria-label="Mozilla Observatory Security Rating: A+">A+</a></span>
<span class=badge-description>Mozilla Observatory Security Rating</span></p></div></div></footer></body></html>